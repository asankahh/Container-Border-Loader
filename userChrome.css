/* 1. DEFINE THE ANGLE */
@property --zen-loading-angle {
  syntax: "<angle>";
  inherits: false;
  initial-value: 0deg;
}

/* 2. THE ANIMATION SETTING */
@keyframes border-spin {
    to { --zen-loading-angle: 360deg; }
}

/* 3. THE LOADING BORDER (Applied to ANY busy tab) */
.tabbrowser-tab[busy] .tab-background::before {
    content: "";
    display: block;
    position: absolute;
    inset: 0; 
    border-radius: inherit; 
    padding: 2px; 
    
    /* SMOOTH SEAMLESS GRADIENT */
    background: conic-gradient(
        from var(--zen-loading-angle), 
        transparent 0%, 
        var(--identity-icon-color, #ff00cc) 15%, 
        transparent 50%,
        transparent 100%
    );
    
    -webkit-mask: 
       linear-gradient(#fff 0 0) content-box, 
       linear-gradient(#fff 0 0);
    mask: 
       linear-gradient(#fff 0 0) content-box, 
       linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    
    animation: border-spin 1.5s linear infinite;
    z-index: 1000;
    pointer-events: none;
    
    /* Make background tabs slightly dimmer so they don't distract */
    opacity: 0.8; 
}

/* 4. FORCE FULL OPACITY FOR ACTIVE TAB */
.tabbrowser-tab[selected][busy] .tab-background::before {
    opacity: 1;
}

/* 5. HIDE WHEN NOT LOADING */
.tabbrowser-tab:not([busy]) .tab-background::before {
    display: none;
}
